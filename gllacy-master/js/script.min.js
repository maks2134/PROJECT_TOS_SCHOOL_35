"use strict";function changePriceFrom(){var e=priceTo.value-priceFrom.value;0>e&&(priceFrom.value=priceTo.value,e=0),labelFrom.innerText=priceFrom.value,priceRange.style.left=RANGE_MARGIN+parseInt((priceFrom.value-PRICE_MIN)/PRICE_DIAPAZON*RANGE_WIDTH)+"px",priceRange.style.width=parseInt(e/PRICE_DIAPAZON*RANGE_WIDTH)+"px"}function changePriceTo(){var e=priceTo.value-priceFrom.value;0>e&&(priceTo.value=priceFrom.value,e=0),labelTo.innerText=priceTo.value,priceRange.style.width=parseInt(e/PRICE_DIAPAZON*RANGE_WIDTH)+"px"}function sliderInit(){if(sliderId>1){var e=document.querySelector("#slider-"+sliderId);e&&(e.checked=!0),setBackground(sliderId)}setSliderListeners()}function setSliderListeners(){var e=document.querySelectorAll("input[name='slider']");if(e)for(var t=0;t<e.length;t++)e[t].addEventListener("change",function(e){setBackground(e.target.id[7]),isStorageSupport&&localStorage.setItem("sliderId",e.target.id[7])})}function setBackground(e){document.body.classList.remove("bg-green","bg-blue","bg-light-brown"),e-=1,sliderColors[e]&&document.body.classList.add(sliderColors[e])}function evtWindowKeydown(e){if(27===e.keyCode&&(formFeedback.classList.contains("hidden")||(e.preventDefault(),formFeedback.classList.add("hidden"))),32===e.keyCode){var t=e.target.classList.contains("button-search"),r=e.target.classList.contains("login-link"),i=e.target.classList.contains("basket-link"),a=!(!e.target.nextElementSibling||!e.target.nextElementSibling.classList.contains("catalog-menu"));a&&(e.preventDefault(),e.target.classList.toggle("menu-item-hover"),catalogMenu.classList.toggle("showed")),t&&!isVisible(formSearch)&&(e.preventDefault(),formSearch.classList.add("showed"),formSearch.querySelector("input").focus()),r&&!isVisible(userAuth)&&(e.preventDefault(),userAuth.classList.add("showed"),userAuth.querySelector("input").focus()),i&&basket&&(e.preventDefault(),basket.classList.toggle("showed"))}}function evtButtonFeedbackClick(){formFeedback.classList.remove("hidden"),formFeedback.querySelector("#feedback-name").focus();var e=formFeedback.querySelector(".button-close");e.addEventListener("click",function(){formFeedback.classList.add("hidden")})}function evtFormSearchSubmitValidation(e){searchField.value||(e.preventDefault(),showEventError(searchField))}function evtFieldInputValidation(e){var t="";switch(e.target.name){case"seach-text":t=searchField;break;case"user-login":t=loginField;break;case"user-password":t=paswdField;break;case"subscribe-mail":t=subscribeField;break;case"feedback-name":t=feedbackNameField;break;case"feedback-mail":t=feedbackMailField;break;case"feedback-message":t=feedbackMessField}t&&t.value&&t.classList.remove("border-error")}function evtUserAuthSubmitValidation(e){loginField.value&&paswdField.value?isStorageSupport&&localStorage.setItem("login",loginField.value):(e.preventDefault(),loginField.value?paswdField.value||(paswdField.placeholder="Введите пароль",showEventError(paswdField)):(loginField.placeholder="Введите логин",showEventError(loginField)))}function evtSubscribeValidation(e){subscribeField.value||(e.preventDefault(),showEventError(subscribeField))}function evtFeedbackValidation(e){feedbackNameField.value&&feedbackMailField.value&&feedbackMessField.value||(e.preventDefault(),feedbackNameField.value?feedbackMailField.value?feedbackMessField.value||showEventError(feedbackMessField):showEventError(feedbackMailField):showEventError(feedbackNameField))}function showEventError(e){"object"==typeof e&&(e.classList.add("border-error"),e.classList.remove("error"),e.classList.add("error"),setTimeout(function(){e.classList.remove("error")},700))}function evtBasketDeleteClick(e){var t=e.target.closest("tr");if(t.remove(),!basketPopup)return!1;var r=0,i=0,a=basketPopup.querySelectorAll(".basket-list .product-sum");a.length&&a.forEach(function(e){i++;var t=e.innerText.slice(0,e.innerText.indexOf(" руб."));t=t.replace(/\s/g,""),r+=+t});var o=document.querySelector(".main-nav .basket");if(r||i){var l=basketPopup.querySelectorAll(".basket-sum span");l[0].innerText=r,o.querySelector(".basket-link").innerText=i+" товар"}else basketPopup.style.display="none",basketPopup.remove(),o.classList.remove("not-empty"),o.querySelector(".basket-link").innerText="Пусто"}function isVisible(e){return"block"==getComputedStyle(e).display}function showFrameMap(){var e=document.querySelector(".office-map .map");if(e){var t=e.querySelector("iframe");null===t&&(t=document.createElement("iframe"),t.width=1200,t.height=430,t.className="hidden",t.src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1998.6036253003365!2d30.32085871651319!3d59.93871916905374!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x4696310fca145cc1%3A0x42b32648d8238007!2z0JHQvtC70YzRiNCw0Y8g0JrQvtC90Y7RiNC10L3QvdCw0Y8g0YPQuy4sIDE5LzgsINCh0LDQvdC60YIt0J_QtdGC0LXRgNCx0YPRgNCzLCAxOTExODY!5e0!3m2!1sru!2sru!4v1561079752419!5m2!1sru!2sru",t.title=t.innerHTML="Адрес главного офиса и офлайн-магазина: ул. Большая Конюшенная 19/8, Санкт-Петербург",e.appendChild(t),t.addEventListener("load",function(){t.classList.remove("hidden")}))}}var sliderId=0,prevSlider="slider-1",sliderColors=["bg-green","bg-blue","bg-light-brown"],isStorageSupport=!0,storageLogin="",formSearch=document.querySelector(".form-search"),searchField=formSearch.querySelector("[name='seach-text']"),buttonAuth=document.querySelector(".login-link"),userAuth=document.querySelector(".user-auth"),loginField=userAuth.querySelector("[name='user-login']"),paswdField=userAuth.querySelector("[name='user-password']"),buttonBasket=document.querySelector(".basket"),basket=document.querySelector(".basket-popup"),formSubscribe=document.querySelector(".form-subscribe"),formFeedback=document.querySelector(".form-feedback");try{sliderId=localStorage.getItem("sliderId")}catch(e){isStorageSupport=!1}if(sliderInit(),showFrameMap(),isStorageSupport&&(storageLogin=localStorage.getItem("login"),!loginField.value&&storageLogin&&(loginField.value=storageLogin)),window.addEventListener("keydown",evtWindowKeydown),formSearch.addEventListener("submit",evtFormSearchSubmitValidation),searchField.addEventListener("input",evtFieldInputValidation),formSearch.querySelector("input").addEventListener("blur",function(){formSearch.classList.remove("showed")}),buttonAuth.addEventListener("focus",function(){userAuth.classList.remove("showed")}),userAuth.querySelector("a:last-child").addEventListener("blur",function(){userAuth.classList.remove("showed")}),userAuth.addEventListener("submit",evtUserAuthSubmitValidation),loginField.addEventListener("input",evtFieldInputValidation),paswdField.addEventListener("input",evtFieldInputValidation),formSubscribe){formSubscribe.addEventListener("submit",evtSubscribeValidation);var subscribeField=formSubscribe.querySelector("[name='subscribe-mail']");subscribeField.addEventListener("input",evtFieldInputValidation)}if(formFeedback){var buttonFeedback=document.querySelector(".our-adress button");buttonFeedback.addEventListener("click",evtButtonFeedbackClick),formFeedback.addEventListener("submit",evtFeedbackValidation);var feedbackNameField=formFeedback.querySelector("[name='feedback-name']"),feedbackMailField=formFeedback.querySelector("[name='feedback-mail']"),feedbackMessField=formFeedback.querySelector("[name='feedback-message']");feedbackNameField.addEventListener("input",evtFieldInputValidation),feedbackMailField.addEventListener("input",evtFieldInputValidation),feedbackMessField.addEventListener("input",evtFieldInputValidation)}if(basket){buttonBasket.addEventListener("focus",function(){basket.classList.remove("showed")});var basketOrder=basket.querySelector(".button:last-child").addEventListener("blur",function(){basket.classList.remove("showed")})}var catalogMenu=document.querySelector(".catalog-menu"),catalogMenuLink=document.querySelector(".catalog-menu li:last-child a");catalogMenuLink.addEventListener("blur",function(){document.querySelector(".main-menu li:first-child a").classList.remove("menu-item-hover"),catalogMenu.classList.remove("showed")});var basketPopup=document.querySelector(".basket-popup");if(basketPopup){var buttonBasketDelete=basketPopup.querySelectorAll(".product-rm");buttonBasketDelete.length&&buttonBasketDelete.forEach(function(e){e.addEventListener("click",evtBasketDeleteClick)})}var blockPrice=document.querySelector(".price-by"),priceFrom=document.querySelector("#filter-price-from"),labelFrom=document.querySelector(".label-price-from"),priceTo=document.querySelector("#filter-price-to"),labelTo=document.querySelector(".label-price-to");const PRICE_MIN=100,PRICE_MAX=500,PRICE_DIAPAZON=400,RANGE_MARGIN=21,RANGE_WIDTH=176;if(blockPrice){var priceRange=document.createElement("div");priceRange.className="price-range",blockPrice.appendChild(priceRange),labelFrom.innerText=priceFrom.value,labelTo.innerText=priceTo.value,changePriceFrom(),priceFrom.addEventListener("focus",function(){blockPrice.classList.add("focus")}),priceFrom.addEventListener("blur",function(){blockPrice.classList.remove("focus")}),priceTo.addEventListener("focus",function(){blockPrice.classList.add("focus")}),priceTo.addEventListener("blur",function(){blockPrice.classList.remove("focus")}),priceFrom.addEventListener("input",changePriceFrom),priceTo.addEventListener("input",changePriceTo)}var blockFat=document.querySelector(".filter-form ul.fat");if(blockFat){var fieldsFat=blockFat.querySelectorAll(".input-type [type='radio']");fieldsFat.length&&fieldsFat.forEach(function(e){e.addEventListener("focus",function(){blockFat.classList.add("focus")}),e.addEventListener("blur",function(){blockFat.classList.remove("focus")})})}var blockFiller=document.querySelector(".filter-form ul.fillers");if(blockFiller){var fieldsFiller=blockFiller.querySelectorAll(".input-type [type='checkbox']");fieldsFiller.length&&fieldsFiller.forEach(function(e){e.addEventListener("focus",function(){blockFiller.classList.add("focus")}),e.addEventListener("blur",function(){blockFiller.classList.remove("focus")})})}